<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino's Atelier - Magazine</title>
    <style>
        body { background: #000; color: #fff; font-family: "Courier New", Courier, monospace; margin: 0; padding: 0; overflow-x: hidden; }
        #top-nav { display: flex; justify-content: space-between; padding: 20px; border-bottom: 1px solid #333; position: sticky; top: 0; background: #000; z-index: 1000; transition: top 0.3s; }
        
        .magazine-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 40px; 
            padding: 40px; 
            max-width: 1200px; 
            margin: 0 auto;
        }
        
        .item { text-align: center; position: relative; margin-bottom: 20px; }
        .item img { width: 100%; height: auto; border: 1px solid #222; transition: transform 0.3s, border-color 0.3s; }
        .item img:hover { border-color: #fff; transform: scale(1.02); }
        .sold-out { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(255,0,0,0.8); color: white; padding: 12px 20px; font-weight: bold; pointer-events: none; z-index: 10; }
        
        #black-market-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 20000; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .quiz-container { max-width: 600px; margin: 50px auto; text-align: center; }
        .quiz-coin-board {
    display: flex;
    justify-content: space-between;
    background: #ffffff;
    padding: 12px 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    color: #000;
}
        .option-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; background: #111; color: #fff; border: 1px solid #444; cursor: pointer; text-align: left; font-size: 16px; }
        .option-btn:hover { background: #fff; color: #000; }
        
        /* é è¨­é»‘å¸‚æŒ‰éˆ•ç‚ºéš±è—ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º */
        #floating-market-btn { display: none; position: fixed; bottom: 30px; right: 30px; background: #fff; color: #000; padding: 15px 25px; cursor: pointer; font-weight: bold; border-radius: 50px; z-index: 1000; box-shadow: 0 4px 15px rgba(255,255,255,0.2); }
        #floating-market-btn.disabled { background: #333; color: #888; cursor: not-allowed; }
        #refresh-btn { position: fixed; bottom: 30px; left: 30px; background: rgba(255,255,255,0.1); color: #fff; padding: 10px 15px; cursor: pointer; font-size: 12px; border: 1px solid #444; z-index: 1000; }
        
        @media (max-width: 600px) {
            .magazine-grid { grid-template-columns: repeat(1, 1fr); padding: 20px; }
        }
    </style>
</head>
<body>

<div id="browser-notice" style="display:none; background:#ff4b4b; color:white; padding:12px; font-size:13px; text-align:center; position:fixed; top:0; width:100%; z-index:10000; letter-spacing:1px; line-height:1.4;">
    âš ï¸ åµæ¸¬åˆ°æ‚¨æ­£ä½¿ç”¨ App å…§å»ºç€è¦½å™¨ã€‚å»ºè­°é»é¸å³ä¸Šè§’ã€Œä½¿ç”¨ç€è¦½å™¨é–‹å•Ÿã€ä»¥ç¢ºä¿ä¸‹å–®é †æš¢ã€‚
    <span onclick="this.parentElement.style.display='none'" style="margin-left:15px; cursor:pointer; font-weight:bold; text-decoration:underline;">[ é—œé–‰ X ]</span>
</div>

<nav id="top-nav">
    <div id="nav-back" style="cursor:pointer;" onclick="window.location.href='index.html'">â† ATELIER</div>
    <div style="letter-spacing:5px; font-weight: bold;">DINO'S MAGAZINE</div>
    <div id="coin-display">COINS: <span id="coin-count">3</span> ğŸŸ</div>
</nav>

<div class="magazine-grid" id="magazine-grid"></div>

<div id="floating-market-btn" onclick="openMarket()">{ é€²å…¥é»‘å¸‚ }</div>
<div id="refresh-btn" onclick="manualRefresh()">ğŸ”„ SYNC STOCK</div>

<div id="black-market-overlay">
    <div style="text-align: right;"><button onclick="confirmCloseMarket()" style="background:none; color:#fff; border:none; font-size:24px; cursor:pointer;">Ã—</button></div>
    <div class="quiz-container">
        <div id="black-market-overlay" style="display:none;">
    <div class="quiz-container">
        <div id="quiz-coin-board" class="quiz-coin-board">
            <div style="text-align: left;">
                <span style="color: #666; font-size: 12px; font-weight: bold;">é›œèªŒæŒæœ‰</span><br>
                <span id="quiz-orig-coins" style="font-size: 20px; font-weight: 900;">0</span> ğŸŸ
            </div>
            <div style="text-align: right;">
                <span style="color: #888; font-size: 12px; font-weight: bold;">é»‘å¸‚è³ºå–</span><br>
                <span style="font-size: 18px;">+</span>
                <span id="quiz-temp-coins" style="font-size: 20px; font-weight: 900;">0</span> ğŸŸ
            </div>
        </div>

        <p id="quiz-story"></p>
        <p id="quiz-question" style="font-size: 20px; font-weight: bold; margin-bottom: 30px;"></p>
        <div id="quiz-options"></div>
        <button class="close-btn" onclick="confirmCloseMarket()">Ã—</button>
    </div>
</div>
       
        <p id="quiz-story" style="color:#888; font-style:italic; margin-bottom:20px; min-height:60px;"></p>
        <p id="quiz-question" style="font-size:20px; font-weight:bold; margin-bottom:30px;"></p>
        <div id="quiz-options"></div>
        <p id="quiz-leave" onclick="confirmCloseMarket()" style="margin-top:40px; color:#555; cursor:pointer; text-decoration:underline; font-size:12px;">LEAVE MARKET</p>
    </div>
</div>

<script>
    const STOCK_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTwOll10EJ23JtCAxUzRtOY6r8yW0yc0Tgn9TyuloPl4pR1lPuuVK5iOpV1KmAkaY4kSq1Jcj6OiQP0/pub?gid=488908997&single=true&output=csv';
    const ORDER_FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLScWck40_ZDTAutZ6PT6cq3koXbHUyplsl8lcoASe2ACTlZXOg/viewform';
    const BLACK_MARKET_FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLScv7hqzJEcDXYX7BpIEfs5c2NmNfLOpUnWIxa1blxE9gU9afw/viewform';
    const OPEN_DATE = new Date("Feb 08, 2026 10:00:00").getTime(); 

    const urlParams = new URLSearchParams(window.location.search);
    const isPreviewMode = urlParams.get('mode') === 'preview';
    const isDeveloper = urlParams.get('dev') === 'otter921008';

    let coins = localStorage.getItem('dino_coins') !== null ? parseInt(localStorage.getItem('dino_coins')) : 3;
    let hasOrdered = localStorage.getItem('dino_ordered') === 'true';
    let inventory = {};
    let currentQuiz = -1;

    function renderGrid() {
        const grid = document.getElementById('magazine-grid');
        grid.innerHTML = '';
        const now = new Date().getTime();
        for (let i = 1; i <= 12; i++) {
            const stock = inventory[i] !== undefined ? inventory[i] : '...';
            const isSoldOut = (stock !== '...' && stock <= 0);
            const item = document.createElement('div');
            item.className = 'item';
            const canClick = !isPreviewMode && (now >= OPEN_DATE || isDeveloper);
            const cursorStyle = (isSoldOut || !canClick) ? "default" : "pointer";
            item.innerHTML = `
                <img src="cloth${i}.jpg?v=0109" style="cursor: ${cursorStyle};" onclick="orderItem(${i})">
                <h3>ITEM #${String(i).padStart(3, '0')}</h3>
                <p style="color:#aaa; font-size:11px;">PRICE: 3 ğŸŸ</p>
                <p>STOCK: ${stock}</p>
                ${isSoldOut ? '<div class="sold-out">SOLD OUT</div>' : ''}
            `;
            grid.appendChild(item);
        }
    }

    function safeOpen(url) {
        const newWin = window.open(url, '_blank');
        if (!newWin || newWin.closed || typeof newWin.closed == 'undefined') window.location.href = url;
    }

    function orderItem(id) {
        const now = new Date().getTime();
        if (now < OPEN_DATE && !isDeveloper) {
            alert("ğŸ”’ é›œèªŒé è¦½ä¸­ã€‚æ­£å¼ç™¼å”®æ™‚é–“ç‚º 2/8 AM 10:00ï¼Œæ•¬è«‹æœŸå¾…ï¼");
            return;
        }
        if (isPreviewMode && !isDeveloper) return;
        if (hasOrdered && !isDeveloper) { alert("è£ç¸«å¸«æé†’ï¼šæ¯äººé™è³¼ä¸€ä»¶ï¼"); return; }
        if (inventory[id] <= 0) return;
        if (coins < 3) { alert("é­šå¹£ä¸è¶³ï¼"); return; }
        
        if (confirm(`ç¢ºå®šå…Œæ› ITEM #${String(id).padStart(3, '0')}ï¼Ÿ`)) {
            coins -= 3; hasOrdered = true;
            localStorage.setItem('dino_coins', coins);
            localStorage.setItem('dino_ordered', 'true');
            document.getElementById('coin-count').innerText = coins;
            safeOpen(`${ORDER_FORM_URL}?usp=pp_url&entry.94643144=${encodeURIComponent("#"+id)}`);
            renderGrid();
        }
    }

    function checkMarketStatus() {
    const btn = document.getElementById('floating-market-btn');
    const now = new Date().getTime();
    const hasEntered = localStorage.getItem('dino_market_entered');

    // --- é—œéµä¿®æ”¹ï¼šå¦‚æœæ˜¯ç®¡ç†å“¡ï¼Œç›´æ¥è·³éæ™‚é–“æª¢æŸ¥ ---
    if (isDeveloper) {
        // ç®¡ç†å“¡æ¨¡å¼ï¼šæŒ‰éˆ•æ°¸é é¡¯ç¤ºï¼Œé™¤éä½ æƒ³è¦æ¸¬è©¦ã€Œé€²å…¥å¾Œé—œé–‰ã€çš„æ•ˆæœ
        btn.style.display = 'block'; 
    } else {
        // ä¸€èˆ¬è¨ªå®¢æ¨¡å¼ï¼šæª¢æŸ¥æ˜¯å¦åˆ°é”é–‹å•Ÿæ—¥æœŸ
        if (now < OPEN_DATE) {
            btn.style.display = 'none';
            return;
        }
        btn.style.display = 'block';
    }

    // --- æª¢æŸ¥æ˜¯å¦å·²é€²å…¥é ---
    if (hasEntered === 'true') {
        btn.innerHTML = "{ é»‘å¸‚å·²é—œé–‰ }";
        btn.classList.add('disabled');
        btn.onclick = () => alert("æ©Ÿæœƒåªæœ‰ä¸€æ¬¡ï¼Œé»‘å¸‚å¤§é–€å·²é—œé–‰ã€‚");
    } else {
        btn.innerHTML = "{ é€²å…¥é»‘å¸‚ }";
        btn.classList.remove('disabled');
        btn.onclick = openMarket;
    }
}

    const questions = [
        { story: "ã€Œåœ‹ç‹çš„ç”Ÿæ—¥?ã€", q: "å•é¡Œ 1ï¼šæç‡¦çš„ç”Ÿæ—¥æ˜¯å¹¾è™Ÿ?", a: ["2/10", "2/11", "2/12", "3/11"], correct: 1 },
        { story: "ã€Œé¡å­è£¡æ‰€ç…§çš„æˆ‘ååˆ†é™Œç”Ÿã€‚ã€", q: "å•é¡Œ 2ï¼šæç‡¦æˆå¹´é«˜ä¸­ç•¢æ¥­çš„Soloæ›²æ˜¯?", a: ["Wait", "Last Order", "Zero", "High Five"], correct: 2 },
        { story: "ã€Œä½†ä½ ä¸æ˜¯ä¸€å€‹äººã€‚ã€", q: "å•é¡Œ 3ï¼šã€ŠWaitã€‹èŠ±çµ® MVæ‹æ”æ™‚,æœ‰å¹¾ä½å“¥å“¥åˆ°å ´åŠ æ²¹?", a: ["10", "11", "12", "13"], correct: 2 },
        { story: "ç¶“éä¸€æ’å±•ç¤ºæ¶,ä¸Šé¢æ”¾è‘—æ¼”å”±æœƒæœè£ã€‚", q: "å•é¡Œ 4ï¼šSEVENTEEN RIGHT HEREæ¼”å”±æœƒã€ŒéŸ“åœ‹å ´ã€Rainèˆå°ç¬¬ä¸€å¤©èˆ‡ç¬¬äºŒå¤©è¡¨æ¼”æœ‰ä½•ä¸åŒ?", a: ["é‹å­", "æ‰‹å¥—", "è‡‚ç’°", "éº¥å…‹é¢¨"], correct: 2 },
        { story: "ç§‹å¤©çš„è½è‘‰å¥½å¤šã€‚", q: "å•é¡Œ 5ï¼šDino Danceologyä¸­,å’ŒçŸ¥ç§€ä¸€èµ·åœ¨å“ªè£¡æ‹æ”èˆè¹ˆçš„?", a: ["æ±äº¬", "å¤§é˜ª", "é¦–çˆ¾", "åå¤å±‹"], correct: 3 },
        { story: "ã€Œç¬¬ä¸€æ¬¡èº«æ—æ²’æœ‰æˆå“¡ç«™ä¸Šäº†ä½•è™•çš„åœ‹éš›èˆå°?ã€", q: "å•é¡Œ 6ï¼šæç‡¦ä»Šå¹´ç¨è‡ªä¸€äººå‡ºåœ‹è¡¨æ¼”,æ˜¯å»å“ªè£¡?", a: ["æ—¥æœ¬", "ç¾åœ‹", "æ²™çƒåœ°é˜¿æ‹‰ä¼¯", "æ³•åœ‹"], correct: 2 },
        { story: "ã€Œå»å¹´,æç‡¦èµ°å‡ºäº†å¤šå°‘æ¬¡ã€éšŠä¼ä»¥å¤–ã€?ã€", q: "å•é¡Œ 7ï¼šæç‡¦ 2025å¹´å…±æœ‰å¹¾æ¬¡ã€ŒéšŠå¤–ã€åˆä½œ?", a: ["4 æ¬¡", "5 æ¬¡", "6 æ¬¡", "7 æ¬¡"], correct: 2 },
        { story: "DINO'S DANCEOLOGY Reaction", q: "å•é¡Œ 8ï¼šæ˜¯å“ªä¸€å¹´çš„ç”Ÿæ—¥ç›´æ’­ï¼Œæç‡¦åšäº† danceology çš„å›é¡§?", a: ["2018", "2019", "2020", "2021"], correct: 3 },
        { story: "åœ¨æœˆå…‰ä¹‹ä¸‹è·³èˆï¼Œç›®å…‰åªæ³¨è¦–è‘—ä½ ã€‚", q: "å•é¡Œ 9ï¼šLilili Yabbay åä¸‰æœˆçš„èˆ å‰é¢èººè‘—éƒ¨åˆ†ï¼Œæç‡¦å¾ä¸Šé¢æ•¸ä¾†ç¬¬å¹¾å±¤?", a: ["1", "2", "3", "4"], correct: 1 },
        { story: "æ˜¯è¢«å“¥å“¥å€‘åœç¹çš„å¿™å…§å•Š~", q: "å•é¡Œ 10ï¼š2020å¹´æˆå“¡èšåœ¨ä¸€èµ·æ…¶ç¥æç‡¦ç”Ÿæ—¥ï¼Œé€äº†ä¸€æŸèŠ±13æœµä»£è¡¨13ä½æˆå“¡ï¼Œå…¶ä¸­ä»£è¡¨æç‡¦çš„èŠ±æ˜¯ä»€éº¼é¡è‰²", a: ["é»ƒè‰²", "è—è‰²", "ç´…è‰²", "ç²‰è‰²"], correct: 0 },
        { story: "ã€ŒDinoå•Š å†ä¾†ä¸€é¡Œ100åˆ†çš„å§^^ã€", q: "å•é¡Œ 9ï¼šæç‡¦æ˜¯å“ªä¸€å¥³åœ˜çš„ç²‰çµ²?", a: ["Apink", "f(x)", "EXID", "2NE1"], correct: 0 },
        { story: "å°é¢å¯«è‘—â€”â€”ã€Šæ°´çºè§€å¯Ÿæ—¥è¨˜ã€‹", q: "å•é¡Œ 12ï¼šä»¥ä¸‹å“ªä¸€å€‹ã€Œæ²’æœ‰ã€è¢«æ”¶éŒ„åœ¨hys_921008ã€Šæ°´çºè§€å¯Ÿæ—¥è¨˜ã€‹ä¸­?", a: ["é¼“å˜´", "æ‚è‡‰", "éœ²é½’ç¬‘", "çœ¼é¡"], correct: 3 },
        { story: "ã€Œæœ‰ä¸€å€‹é¡è‰²ååˆ†è€€çœ¼ã€‚ã€", q: "å•é¡Œ 13ï¼šæ°´çºè£ç¸«å¸«æœ€å–œæ­¡æç‡¦çš„å“ªä¸€å€‹é«®è‰²?", a: ["é»‘è‰²", "é‡‘è‰²", "ç´…è‰²", "è—è‰²"], correct: 3 }
    ];

   function openMarket() {
    const hasEnteredBefore = localStorage.getItem('dino_market_entered');
    
    // --- ä¿®æ”¹ï¼šä¸è«–æ˜¯ä¸æ˜¯ç®¡ç†å“¡ï¼Œåªè¦æ²’é€²å»éï¼Œéƒ½è·³æé†’ ---
    if (hasEnteredBefore !== 'true') {
        const confirmEntry = confirm("âš ï¸ æ³¨æ„ï¼šé»‘å¸‚æŒ‘æˆ°æ©Ÿæœƒåªæœ‰ä¸€æ¬¡ï¼\nä¸€æ—¦é€²å…¥ï¼Œç„¡è«–æ˜¯å¦å®Œæˆæ¸¬é©—ï¼Œå¤§é–€éƒ½å°‡é—œé–‰ã€‚\n\nä½ æº–å‚™å¥½è­‰æ˜ä½ å°æç‡¦çš„äº†è§£äº†å—ï¼Ÿ");
        if (!confirmEntry) return; 
    }

    // --- ä¿®æ”¹ï¼šä¸è«–æ˜¯ä¸æ˜¯ç®¡ç†å“¡ï¼Œé»æ“Šã€Œç¢ºå®šã€å¾Œéƒ½ç´€éŒ„ã€Œå·²é€²å…¥ã€ ---
    localStorage.setItem('dino_market_entered', 'true');
    checkMarketStatus();
    
    // ç¢ºä¿çœ‹æ¿æ˜¯é¡¯ç¤ºçš„
    document.getElementById('quiz-coin-board').style.display = 'flex';
    
    document.getElementById('black-market-overlay').style.display = 'block';
    currentQuiz = -1;
    showQuestion();
}

   let temporaryCoins = 0; 

    function showQuestion() {
    const storyP = document.getElementById('quiz-story');
    const questionP = document.getElementById('quiz-question');
    const optionsDiv = document.getElementById('quiz-options');
    const board = document.getElementById('quiz-coin-board');
    
    // æ›´æ–°çœ‹æ¿ä¸Šçš„æ•¸å­—
    document.getElementById('quiz-orig-coins').innerText = coins;
    document.getElementById('quiz-temp-coins').innerText = temporaryCoins;

    if (currentQuiz === -1) {
        temporaryCoins = 0; 
        board.style.display = 'flex'; // é¡¯ç¤ºçœ‹æ¿
        storyP.innerText = "å°‹æ‰¾å‚³èªªä¸­çš„è¨­è¨ˆå¸«â€”â€”æ°´çºè£ç¸«å¸«ã€‚";
        questionP.innerHTML = "è­‰æ˜ä½ å°æç‡¦çš„äº†è§£ï¼Œæ‰èƒ½è¦‹åˆ°ä»–çš„çœŸé¢ç›®ã€‚";
        optionsDiv.innerHTML = `<button class="option-btn" onclick="currentQuiz=0; showQuestion();">é–‹å§‹æŒ‘æˆ°</button>`;
        return;
    }
    
    if (currentQuiz >= questions.length) {
        board.style.display = 'none'; // çµæŸæ™‚éš±è—çœ‹æ¿
        storyP.innerText = "æŒ‘æˆ°çµæŸï¼";
        const totalPotential = coins + temporaryCoins; 
        
        questionP.innerHTML = `
            <div style="background: #ffffff; padding: 25px; border-radius: 15px; text-align: center; color: #000;">
                <p style="color: #666; margin-bottom: 5px;">æœ¬æ¬¡ç²å¾—é¡å¤–ï¼š+${temporaryCoins} ğŸŸ</p>
                <p style="font-size: 24px; font-weight: 900; margin: 0;">æœ€çµ‚æŒæœ‰ï¼š${totalPotential} ğŸŸ</p>
                <p style="color: #ff4b4b; font-size: 13px; font-weight: bold; margin-top: 15px;">ğŸ’¡ é­šå¹£æ„ˆå¤šï¼ŒæŠ½çæ©Ÿç‡æ„ˆé«˜ï¼</p>
            </div>
        `;
        optionsDiv.innerHTML = `<button class="option-btn" style="background:#fff; color:#000; font-weight:bold; border:2px solid #000;" onclick="finalizeMarketCoins()">ç¢ºèªé ˜å–ä¸¦ç™»è¨˜</button>`;
        return;
    }

    const data = questions[currentQuiz];
    storyP.innerText = data.story;
    questionP.innerText = data.q;
    optionsDiv.innerHTML = '';
    data.a.forEach((txt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = `${String.fromCharCode(65 + idx)}. ${txt}`;
        btn.onclick = () => {
            if (idx === data.correct) {
                temporaryCoins += 2;
                alert("æ­£ç¢ºï¼");
            } else {
                alert("ç­”éŒ¯äº†...æ²’é—œä¿‚ç¹¼çºŒæŒ‘æˆ°ã€‚");
            }
            currentQuiz++; 
            showQuestion();
        };
        optionsDiv.appendChild(btn);
    });
}

    // æ­£å¼æŠŠæš«å­˜é­šå¹£å­˜å…¥ localStorage
    function finalizeMarketCoins() {
        coins += temporaryCoins;
        localStorage.setItem('dino_coins', coins);
        document.getElementById('coin-count').innerText = coins;

        const verifyCode = (coins * 17) + 211;
        const targetUrl = `${BLACK_MARKET_FORM_URL}?usp=pp_url&entry.94782409=${coins}&entry.1993098186=${verifyCode}`;
        
        alert("é­šå¹£å·²æˆåŠŸå­˜å…¥å¸³æˆ¶ï¼å³å°‡è·³è½‰è‡³ç™»è¨˜è¡¨å–®ã€‚");
        safeOpen(targetUrl);
        
        // é—œé–‰é»‘å¸‚è¦–çª—
        document.getElementById('black-market-overlay').style.display = 'none';
    }

    function confirmCloseMarket() {
        if (confirm("âš ï¸ æ³¨æ„ï¼šä¸€æ—¦é—œé–‰è¦–çª—ï¼Œå‰›æ‰ç­”å°è³ºå–çš„é­šå¹£å°‡æœƒæ¶ˆå¤±ï¼Œä¸”ç„¡æ³•å†æ¬¡é€²å…¥ã€‚ç¢ºå®šè¦é›¢é–‹ï¼Ÿ")) {
            document.getElementById('black-market-overlay').style.display = 'none';
        }
    }

    async function syncStock() {
        try {
            const res = await fetch(`${STOCK_CSV_URL}&t=${new Date().getTime()}`);
            const text = await res.text();
            const rows = text.split('\n').filter(r => r.trim() !== '').slice(1);
            rows.forEach(row => {
                const cols = row.split(',');
                if (cols.length >= 3) {
                    const id = parseInt(cols[0]);
                    const count = parseInt(cols[2]);
                    if (!isNaN(id)) inventory[id] = count;
                }
            });
            renderGrid();
        } catch (e) { console.log(e); }
    }

    function manualRefresh() { syncStock(); alert("åŒæ­¥æˆåŠŸï¼"); }

    function initDevMode() {
        if (isDeveloper) {
            const devBtn = document.createElement('div');
            devBtn.innerHTML = "ğŸ› ï¸ DEV";
            devBtn.style = "position:fixed; bottom:20px; left:120px; background:red; color:white; padding:10px; z-index:9999; cursor:pointer; font-size:10px;";
            devBtn.onclick = () => {
                const choice = prompt("1: è¨­å®šå¹£, 2: é‡ç½®è³¼è²·, 3: é‡ç½®é»‘å¸‚");
                if (choice === "1") { 
                    let n = prompt("æ•¸é‡?"); if(n) { coins = parseInt(n); localStorage.setItem('dino_coins', coins); document.getElementById('coin-count').innerText = coins; }
                } else if (choice === "2") { localStorage.setItem('dino_ordered', 'false'); hasOrdered = false; renderGrid(); }
                else if (choice === "3") { localStorage.removeItem('dino_market_entered'); checkMarketStatus(); }
            };
            document.body.appendChild(devBtn);
        }
    }

    window.onload = () => {
        const ua = navigator.userAgent || navigator.vendor || window.opera;
        if (/FBAN|FBAV|Instagram|Line/i.test(ua)) {
            document.getElementById('browser-notice').style.display = 'block';
            document.getElementById('top-nav').style.top = '45px';
        }
        document.getElementById('coin-count').innerText = coins;
        checkMarketStatus();
        initDevMode();
        syncStock();
    };
</script>
</body>
</html>



















