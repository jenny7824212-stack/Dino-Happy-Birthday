<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DINO'S ATELIER | MAGAZINE SHOP</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">
    <style>
        h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 42px;
    letter-spacing: 5px;
    text-transform: uppercase;
}
        body { 
            background-color: #FAF9F6; 
            color: #333333; 
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; 
            margin: 0; 
            padding-bottom: 100px; 
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; text-align: center; }

        /* ç‹€æ…‹æ¬„ */
        .status-bar { 
            position: fixed; top: 0; width: 100%; 
            background: rgba(255, 255, 255, 0.95); 
            padding: 12px 0; z-index: 1000; 
            border-bottom: 1px solid #eee;
            display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .back-home-btn { 
            background: transparent; color: #555; border: 1px solid #ccc; 
            padding: 5px 15px; border-radius: 20px; text-decoration: none; font-size: 13px; 
        }
        .back-home-btn:hover { border-color: #d4af37; color: #d4af37; }

        .coin-display { font-size: 16px; font-weight: bold; color: #333; }

        /* æ›´æ–°æŒ‰éˆ• */
        .refresh-btn {
            background: #fff; color: #333; border: 1px solid #333; padding: 5px 12px;
            border-radius: 6px; font-size: 12px; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; gap: 5px;
        }
        .refresh-btn:hover { background: #333; color: #fff; }

        .header-section { margin-top: 100px; margin-bottom: 30px; }
        .price-tag { color: #b8860b !important; font-weight: bold; font-size: 14px; }

        /* ç…§ç‰‡å¡ç‰‡ */
        .magazine-gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; padding: 10px; }
        .magazine-card { 
            background: #ffffff; 
            border-radius: 12px; 
            overflow: hidden; 
            border: 1px solid #eee; 
            transition: 0.3s; 
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: relative;
        }
        .magazine-card:hover { transform: translateY(-8px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-color: #d4af37; }
        .magazine-card img { width: 100%; height: auto; display: block; }
        
        .card-info { padding: 15px; background: #ffffff; border-top: 1px solid #eee; text-align: center; }
        .buy-tag { 
            color: #333333; 
            font-weight: 800; 
            font-size: 14px;
            letter-spacing: 1px;
            display: block;
            margin-bottom: 5px;
        }
        .stock-label { font-size: 12px; color: #888; }
        .stock-count { font-weight: bold; color: #d9534f; }

        /* å”®ç½„è¦†è“‹ */
        .sold-out { opacity: 0.5; filter: grayscale(1); pointer-events: none; }
        .sold-out-badge { 
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg); 
            background: rgba(217, 83, 79, 0.9); color: white; padding: 8px 16px; 
            border: 2px solid white; font-weight: bold; z-index: 10; border-radius: 4px; display: none; 
        }

        /* é–‹ç™¼è€…æ¨¡å¼æ¨™ç±¤ */
        .dev-badge { position: fixed; top: 70px; right: 10px; background: #333; color: #fff; padding: 5px; border-radius: 5px; font-size: 10px; cursor: pointer; z-index: 2000; }

        /* é»‘å¸‚æŒ‘æˆ°æŒ‰éˆ• */
        #floating-market-btn { position: fixed; bottom: 30px; right: 30px; background: #ff4b4b; color: white; border: none; padding: 15px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; z-index: 1500; display: none; box-shadow: 0 4px 15px rgba(255, 75, 75, 0.3); }

        /* æ¸¬é©—å½ˆçª— */
        #black-market-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); z-index:2000; overflow-y:auto; }
        .quiz-container { max-width: 600px; margin: 40px auto; text-align: center; padding: 20px; color: white; }
        .option-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; background: #252525; color: #fff; border: 1px solid #444; border-radius: 10px; cursor: pointer; text-align: left; }
    </style>
</head>
<body>

<div class="status-bar">
    <a href="index.html" class="back-home-btn">â† å›åˆ°é¦–é </a>
    <div class="coin-display">æŒæœ‰é­šå¹£: <span id="coin-count">0</span> ğŸŸ</div>
    <button id="refresh-data" class="refresh-btn" onclick="fetchStockData()">
        <span>ğŸ”„</span> æ›´æ–°åº«å­˜
    </button>
</div>

<div class="container">
    <div class="header-section">
        <h2 style="letter-spacing: 4px; font-weight: 900;">[ DINO 27TH BIRTHDAY ]</h2>
        <p>é»æ“Šä¸‹æ–¹ç…§ç‰‡å³å¯é€²è¡Œè¨‚è³¼ç™»è¨˜</p>
        <p class="price-tag">æ¯å¥—éœ€æ¶ˆè€— 3 é­šå¹£ï¼Œä¹Ÿè«‹æ³¨æ„æ°´çºå°ºå¯¸!</p>
    </div>
    <div id="magazine-gallery" class="magazine-gallery"></div>
</div>

<button id="floating-market-btn" onclick="openMarket()">{ é€²å…¥é»‘å¸‚æŒ‘æˆ° }</button>

<div id="black-market-overlay">
    <div class="quiz-container">
        <div id="quiz-coin-board" style="display: flex; justify-content: space-between; background: #ffffff; padding: 15px 25px; border-radius: 15px; margin-bottom: 25px; color: #000;">
            <div style="text-align: left;"><span style="color: #888; font-size: 12px; font-weight: bold;">åŸæœ¬é­šå¹£</span><br><span id="quiz-orig-coins" style="font-size: 20px; font-weight: 900;">0</span> ğŸŸ</div>
            <div style="text-align: right;"><span style="color: #666; font-size: 12px; font-weight: bold;">ç²å¾—çå‹µ</span><br><span id="quiz-temp-coins" style="font-size: 20px; font-weight: 900;">0</span> ğŸŸ</div>
        </div>
        <p id="quiz-story" style="color:#ffd026; font-style:italic; margin-bottom:10px;"></p>
        <p id="quiz-question" style="font-size:22px; font-weight:bold; margin-bottom:30px; color:#fff;"></p>
        <div id="quiz-options"></div>
        <p id="quiz-leave" onclick="handlePenaltyClose()" style="margin-top:50px; color:#888; cursor:pointer; text-decoration:underline;">LEAVE MARKET</p>
    </div>
</div>

<script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTwOll10EJ23JtCAxUzRtOY6r8yW0yc0Tgn9TyuloPl4pR1lPuuVK5iOpV1KmAkaY4kSq1Jcj6OiQP0/pub?gid=488908997&single=true&output=csv";
    const OPEN_DATE = new Date("Feb 08, 2026 10:00:00").getTime();
    const BASE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLScWck40_ZDTAutZ6PT6cq3koXbHUyplsl8lcoASe2ACTlZXOg/viewform?usp=pp_url";
    const BLACK_MARKET_BASE_URL = "https://docs.google.com/forms/d/e/1FAIpQLScv7hqzJEcDXYX7BpIEfs5c2NmNfLOpUnWIxa1blxE9gU9afw/viewform?usp=pp_url";
    const GITHUB_ASSETS = "https://raw.githubusercontent.com/jenny7824212-stack/Dino-Happy-Birthday/main/";

    let coins = parseInt(localStorage.getItem('dino_coins')) || 3;
    let temporaryCoins = 0;
    let currentQuiz = -1;

    const urlParams = new URLSearchParams(window.location.search);
    const isDeveloper = urlParams.get('dev') === 'otter921008';

    const questions = [
    { 
        story: "Dino åˆå¢åŠ ä¸€æ­²äº†å‘¢ï¼Œè¼¸å…¥æ•¸å­—é€²å…¥é»‘å¸‚å§ã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” é€™ä¸€å¤©å…‹æ‹‰éƒ½æœŸå¾…ç›´æ’­è¦‹åˆ°çºã€‚</div>",
        q: "å•é¡Œ 1ï¼šæç‡¦çš„ç”Ÿæ—¥æ˜¯å¹¾è™Ÿ?", 
        a: ["2/10", "2/11", "2/12", "3/11"], 
        correct: 1 
    },
    { 
        story: "ä½ æ³¨æ„åˆ°äº†ä¸€å€‹æ­£åœ¨æ’¥æ”¾çš„æ”¶éŸ³æ©Ÿã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æç‡¦çš„æ—¥æ–‡é›»å°ç¸½æ˜¯å¾ˆæœ‰è¶£ï¼Œè€Œä¸”å­¸ç¿’æ—¥æ–‡ååˆ†åŠªåŠ›å‘¢ã€‚</div>",
        q: "å•é¡Œ 2ï¼šæç‡¦ä¸»æŒçš„SCHOOL OF LOCK æ˜¯å›ºå®šæ¯å€‹æœˆç¬¬å¹¾é€±æ›´æ–°?", 
        a: ["1", "2", "3", "4"], 
        correct: 1 
    },
    { 
        story: "å•†äººè²©è³£åœ‹ç‹è®€æ›¸æ™‚æœŸçš„ç›¸é—œæƒ…å ±ã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æç‡¦é–‹å¿ƒé–‹ç›´æ’­æ‹¿è‘—ç•¢æ¥­è­‰æ›¸ï¼Œååˆ†é©•å‚²ã€‚</div>",
        q: "å•é¡Œ 3ï¼šæç‡¦æˆå¹´é«˜ä¸­ç•¢æ¥­çš„Soloæ›²æ˜¯?", 
        a: ["Wait", "Last Order", "Zero", "High Five"], 
        correct: 2 
    },
    { 
        story: "ä½ é€²å…¥ä¸€é–“é…’é¤¨ï¼Œé…’ä¿èªªåªè¦å›ç­”å•é¡Œæ­£ç¢ºï¼Œèƒ½æä¾›2023å¹´çš„ç´…é…’çµ¦ä½ ã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” Wait é€£çºŒæ‹æ”24å°æ™‚çœŸçš„å¥½è¾›è‹¦ï¼Œä½†å“¥å“¥å€‘éƒ½ä¾†åŠ æ²¹äº†ã€‚</div>",
        q: "å•é¡Œ 4ï¼šã€ŠWaitã€‹èŠ±çµ® MVæ‹æ”æ™‚,æœ‰å¹¾ä½å“¥å“¥åˆ°å ´åŠ æ²¹?", 
        a: ["10", "11", "12", "13"], 
        correct: 2 
    },
    { 
        story: "ä½ åœ¨é»‘å¸‚æ‰¾åˆ°ä¸€å¼µåœ°åœ–ï¼Œç™¼ç¾é»‘å¸‚åˆ†æˆäº†ä¸‰å€ã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” Wait é‚„å¾—æ›åœ°æ–¹æ‹æ”ï¼Œä½†æœ€å¾Œçš„ä½œå“çœŸçš„è¶…å¥½çœ‹ã€‚</div>",
        q: "å•é¡Œ 5ï¼šæ‹æ” wait MV ä»¥ä¸‹éæ‹æ”åœ°é»? (å–è‡ª2023.12.07ç›´æ’­) ", 
        a: ["é¾è·¯å€", "å»£æ´¥å€", "é¾å±±å€", "æ¾å³¶"], 
        correct: 2 
    },
     { 
        story: "ä½ åœ¨é»‘å¸‚é‡åˆ°äº†ä¸€ä½è€å¥¶å¥¶ï¼Œå¥¹æ‹¿äº†ä¸€ç›’é†¬èŸ¹é¼“å‹µä½ ã€‚",
        "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æç‡¦å¥¶å¥¶çš„é†¬èŸ¹ï¼Œç‡¦ä¸€çœ¼å°±çŸ¥é“æ˜¯å“ªå€‹ã€‚</div>",
        q: "å•é¡Œ 6ï¼šæç‡¦å¥¶å¥¶çš„é†¬èŸ¹æ˜¯å“ªè£¡çš„é¢¨æ ¼?", 
        a: ["æ…¶å°šé“", "æ±ŸåŸé“", "å¿ æ¸…é“", "å…¨ç¾…é“"], 
        correct: 3 
    },
    { 
        story: "æ‰¾åˆ°äº†ä»¥å‰åœ‹ç‹æ‹æ”çš„ç¶œè—ç‰‡æ®µï¼Œæ‰®æ¼”å¤§å”çœŸçš„å¥½åƒã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” é™¤äº†èˆå°ï¼Œæç‡¦çš„æ¼”æŠ€çœŸçš„å¥½å²å®³ã€‚</div>",
        q: "å•é¡Œ 7ï¼šä¸‹åˆ—å“ªä¸€å€‹ä¸æ˜¯éµäººå¤§å”åº•ä¸‹è—äºº?", 
        a: ["è¶™ä¹™å¥½", "Charles", "ç¢©ç‰", "Leo"], 
        correct: 0 
    },
    { 
        story: "ç¶“éäº†ä¸€å®¶ç‰™é½’è¨ºæ‰€ï¼Œç™¼ç¾é»‘å¸‚æ›¾ç¶“å› ç‚ºæ°´çºåœ‹ç‹çš„é—œä¿‚ï¼Œæµè¡Œéç‰™é½’è²¼é‘½ã€‚",
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” ç¬‘çš„æ™‚å€™æœƒéœ²å‡ºç‰™é‘½ï¼Œé‚„æœƒä¸å¥½æ„æ€é®ä½ã€‚</div>",
        q: "å•é¡Œ 8ï¼šæç‡¦åœ¨face the sun åšäº†ç‰™é‘½é€ å‹ï¼Œè«‹å•åšäº†å¹¾é¡†ç‰™? ", 
        a: ["2", "3", "4", "5"], 
        correct: 1 
    },
    { 
        story: "åªè¦æ˜¯å­æ°‘éƒ½çŸ¥é“åœ‹ç‹çš„å•Ÿè’™å¶åƒæ˜¯éº¥å¯Â·å‚‘å…‹æ£®ï¼Œè·Ÿè‘—æ•£è½è‘—é€™ä½å‚³å¥‡æµ·å ±çš„è·¯ï¼Œä½ å¾€å‰èµ°äº†éå»ã€‚",
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” ç‡¦çœŸçš„æˆç‚ºäº†éå¸¸è€€çœ¼çš„æ˜æ˜Ÿå‘¢ã€‚</div>",
        q: "å•é¡Œ 9ï¼šåœ¨æç‡¦åƒåŠ çš„æèŒ‚çServiceä¸­ï¼Œå”±çš„æ˜¯éº¥å¯Â·å‚‘å…‹æ£®çš„å“ªä¸€é¦–æ­Œæ›²?", 
        a: ["Beat It", "Thriller", "Billie Jean", "Heal The World"], 
        correct: 3 
    },
    { 
        story: "ä½ ç™¼ç¾äº†ä¸€é–“æœé£¾åº—ï¼Œé€™è£¡æ•´é½Šåœ°æ›è‘— RIGHT HERE æ¼”å”±æœƒçš„æœé£¾ã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” é›–ç„¶å¾ˆæ¼‚äº®ï¼Œä½†å»è¨­è¨ˆä¸è‰¯å—å‚·äº†ã€‚</div>",
        q: "å•é¡Œ 10ï¼šSEVENTEEN RIGHT HEREã€Œé«˜é™½å ´ã€Rainèˆå°ç¬¬ä¸€å¤©èˆ‡ç¬¬äºŒå¤©è¡¨æ¼”æœ‰ä½•ä¸åŒ?", 
        a: ["é‹å­", "æ‰‹å¥—", "è‡‚ç’°", "éº¥å…‹é¢¨"], 
        correct: 2 
    },
    { 
        story: "æ¡Œä¸Šçš„æ”å½±æ©Ÿåœæ ¼åœ¨ä¸€å€‹ç¾éº—çš„ç§‹æ—¥èƒŒæ™¯ä¸‹ï¼Œæ˜¯åœ‹ç‹èˆ‡æˆå“¡å…±èˆçš„ç·šæ¢ã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” ç‡¦å¹«æˆå“¡è¨­è¨ˆèˆè¹ˆçœŸçš„ç‰¹åˆ¥é©åˆã€‚</div>",
        q: "å•é¡Œ 11ï¼šDino Danceologyä¸­,å’ŒçŸ¥ç§€ä¸€èµ·åœ¨å“ªè£¡æ‹æ”èˆè¹ˆçš„?", 
        a: ["æ±äº¬", "å¤§é˜ª", "é¦–çˆ¾", "åå¤å±‹"], 
        correct: 3 
    },
    { 
        story: "ä½ åœ¨æ¡Œä¸Šæ‰¾åˆ°åœ‹ç‹é æ¸¡æµ·æ´‹åŠå¤§é™¸ï¼Œç¨è‡ªç«™ä¸Šèˆå°ã€‚",
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æ·±å¤œçœ‹è‘—ç›´æ’­ï¼ŒçœŸçš„å¾ˆé–‹å¿ƒï¼Œç‡¦èƒ½ç«™ä¸Šå¤§èˆå°ä¸Šè¡¨æ¼”ã€‚</div>",
        q: "å•é¡Œ 12ï¼šæç‡¦2025ç¨è‡ªä¸€äººå‡ºåœ‹è¡¨æ¼”,æ˜¯å»å“ªè£¡?", 
        a: ["æ—¥æœ¬", "ç¾åœ‹", "æ²™çƒåœ°é˜¿æ‹‰ä¼¯", "æ³•åœ‹"], 
        correct: 2 
    },
    { 
        story: "æ³¨æ„åˆ°ç‰†ä¸Šè²¼æ»¿äº†å„é¡ Challenge çš„åˆä½œè¨˜éŒ„ã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æç‡¦è·³ä»»ä½•èˆè¹ˆéƒ½å®Œç¾æ¶ˆåŒ–æ­Œæ›²é¢¨æ ¼ã€‚</div>",
        q: "å•é¡Œ 13ï¼šæç‡¦ 2025å¹´å…±æœ‰å¹¾æ¬¡ã€ŒéšŠå¤–ã€Challenge åˆä½œ(HxWã€BSSã€CxMç®—å…¥éšŠå…§)?", 
        a: ["4 æ¬¡", "5 æ¬¡", "6 æ¬¡", "7 æ¬¡"], 
        correct: 2 
    },
    { 
        story: "æŠ½å±œè£¡æœ‰ä¸€å¼µè¢«ç¿»çˆ›çš„æ¸…å–®ï¼Œä¸Šé¢è¨˜éŒ„è‘—åœ‹ç‹æ­·å¹´çš„ç”Ÿæ—¥å›é¡§ç‰‡æ®µã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” ç”Ÿæ—¥ç›´æ’­çš„è›‹ç³•éƒ½å¾ˆæœ‰è¶£ï¼Œä½†å‘³é“...</div>",
        q: "å•é¡Œ 14ï¼šæ˜¯å“ªä¸€å¹´çš„ç”Ÿæ—¥ç›´æ’­ï¼Œæç‡¦åšäº† danceology çš„å›é¡§?", 
        a: ["2018", "2019", "2020", "2021"], 
        correct: 3 
    },
    { 
        story: "ä½ åœ¨é»‘æš—ä¸­ç™¼ç¾ä¸€ç–Šæ…¢é€Ÿæ”å½±çš„ç…§ç‰‡ï¼Œæ¯ä¸€å¹€éƒ½åœ¨åˆ†æã€Šåä¸‰æœˆçš„èˆã€‹ä¸­ï¼Œåœ‹ç‹é‚£è¼•ç›ˆå¦‚æœˆçš„å§¿æ…‹ã€‚",
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” åä¸‰æœˆçš„èˆï¼Œåœ¨ä¸å­˜åœ¨çš„æ™‚ç©ºï¼Œç«™åœ¨æœˆå…‰ä¸‹è·³èˆï¼Œé€™é¦–æ­Œçš„æ­Œè©çœŸçš„ååˆ†å„ªç¾ã€‚</div>",
        q: "å•é¡Œ 15ï¼šLilili Yabbay åä¸‰æœˆçš„èˆ èˆè¹ˆèººè‘—éƒ¨åˆ†ï¼Œæç‡¦å¾ã€Œä¸Šé¢ã€æ•¸ä¾†ç¬¬å¹¾å±¤?", 
        a: ["1", "2", "3", "4"], 
        correct: 1 
    },
    { 
        story: "çª—é‚Šæ”¾è‘—ä¸€å¼µè™Ÿç¢¼ç‰Œï¼Œä¼¼ä¹æ›¾ç¶“åœ¨ç­‰ä»€éº¼ã€‚",
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æœ€å¾Œä¸€å¹•ç´…è‰²æ¯›è¡£çš„ç‡¦ï¼Œå¿ƒç¸½æ˜¯åœ¨é‚£ç©ºäº†ä¸€æ‹ã€‚</div>",
        q: "å•é¡Œ 16ï¼šåœ¨wait MVä¸­æç‡¦çš„è™Ÿç¢¼ç‰Œæ˜¯å¹¾è™Ÿ?", 
        a: ["365", "211", "526", "214"], 
        correct: 0 
    },
    { 
        story: "æ›è‘—çš„å¤–å¥—å£è¢‹è£¡æ‰“çµçš„è€³æ©Ÿè£¡å‚³ä¾†äº†è¼•å¿«å¥³åœ˜çš„æ›²èª¿ã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” åœ¨ç¶œè—é–‹å¿ƒè·³è‘—å‰è¼©çš„èˆè¹ˆï¼Œç‰¹åˆ¥å¯æ„›ã€‚</div>",
        q: "å•é¡Œ 17ï¼šæç‡¦æ˜¯å“ªä¸€å¥³åœ˜çš„ç²‰çµ²?", 
        a: ["Apink", "f(x)", "EXID", "2NE1"], 
        correct: 0 
    },
    { 
        story: "ã€Œé€™æ˜¯æœ€å¾Œ...ã€ä½ ç™¼ç¾äº†ä¸€æœ¬æ‰‹ç¹ªçš„ã€Šæ°´çºè§€å¯Ÿæ—¥è¨˜ã€‹ï¼Œè¨˜éŒ„è‘—æç‡¦çš„æ¯å€‹ç¬é–“ã€‚", 
         "<div style='font-size: 13px; color:#fac12f; margin-top: 10px; font-weight: normal; opacity: 0.8;'>" +
           "â€”â€” æ„Ÿè¬èµ°åˆ°é€™è£¡ã€‚</div>",
        q: "ç‰¹åˆ¥å•é¡Œ 1ï¼šä»¥ä¸‹å“ªä¸€å€‹ã€Œæ²’æœ‰ã€è¢«æ”¶éŒ„åœ¨hys_921008ã€Šæ°´çºè§€å¯Ÿæ—¥è¨˜ã€‹ä¸­?", 
        a: ["é¼“å˜´", "æ‚è‡‰", "éœ²é½’ç¬‘", "çœ¼é¡"], 
        correct: 3 
    },
    
];
    window.onload = function() {
        const gallery = document.getElementById('magazine-gallery');
        for (let i = 1; i <= 12; i++) {
            const card = document.createElement('div');
            card.className = 'magazine-card';
            card.id = `card-${i}`;
            card.onclick = () => handlePurchase(i);
            card.innerHTML = `
                <div id="badge-${i}" class="sold-out-badge">SOLD OUT</div>
                <img src="${GITHUB_ASSETS}cloth${i}.jpg">
                <div class="card-info">
                    <span class="buy-tag">CLOTH #${i}</span>
                    <span class="stock-label">å‰©é¤˜æ•¸é‡ï¼š<span id="stock-${i}" class="stock-count">--</span></span>
                </div>
            `;
            gallery.appendChild(card);
        }
        updateCoinDisplay();
        fetchStockData();
        checkMarketStatus();
        if (isDeveloper) addDevTool();
    };

    async function fetchStockData() {
        const btn = document.getElementById('refresh-data');
        btn.innerText = "æ›´æ–°ä¸­...";
        try {
            const response = await fetch(`${CSV_URL}&t=${new Date().getTime()}`);
            const data = await response.text();
            const rows = data.split('\n').map(row => row.split(','));

            for (let i = 1; i <= 12; i++) {
                if (rows[i]) {
                    const currentStock = parseInt(rows[i][2]); // Cæ¬„: åº«å­˜
                    document.getElementById(`stock-${i}`).innerText = currentStock;

                    if (currentStock <= 0) {
                        document.getElementById(`card-${i}`).classList.add('sold-out');
                        document.getElementById(`badge-${i}`).style.display = 'block';
                    } else {
                        document.getElementById(`card-${i}`).classList.remove('sold-out');
                        document.getElementById(`badge-${i}`).style.display = 'none';
                    }
                }
            }
        } catch (e) { console.error("æ›´æ–°å¤±æ•—", e); }
        finally { btn.innerHTML = "<span>ğŸ”„</span> æ›´æ–°åº«å­˜"; }
    }

    function updateCoinDisplay() {
        document.getElementById('coin-count').innerText = coins;
    }

    function handlePurchase(itemId) {
        const now = new Date().getTime();
        const stock = parseInt(document.getElementById(`stock-${itemId}`).innerText);
        
        if (now < OPEN_DATE && !isDeveloper) { alert("ğŸ”’ 2/8 10:00 æ­£å¼é–‹å•Ÿã€‚"); return; }
        if (stock <= 0) { alert("æ­¤å•†å“å·²å”®ç½„ï¼"); return; }
        
        // é­šå¹£ä¸è¶³ 3 æšæ™‚éœé»˜çµæŸ
        if (coins < 3) { return; }

        if (confirm(`æ¶ˆè€— 3 é­šå¹£è³¼è²· [ CLOTH #${itemId} ]ï¼Ÿ\n(æ³¨æ„ï¼šæ¯äººåƒ…é™ç™»è¨˜è³¼è²·ä¸€ä»¶)`)) {
            coins -= 3;
            localStorage.setItem('dino_coins', coins);
            updateCoinDisplay();
            window.location.href = `${BASE_FORM_URL}&entry.94643144=%23${itemId}`;
        }
    }

    function checkMarketStatus() {
        const btn = document.getElementById('floating-market-btn');
        const now = new Date().getTime();
        if (isDeveloper || now >= OPEN_DATE) btn.style.display = 'block';
        
        if (localStorage.getItem('dino_market_entered') === 'true') {
            btn.innerHTML = "{ æŒ‘æˆ°å·²çµæŸ }";
            btn.style.background = "#333";
            btn.onclick = () => alert("æŒ‘æˆ°æ©Ÿæœƒåªæœ‰ä¸€æ¬¡ã€‚");
        }
    }

    function openMarket() {
        if (localStorage.getItem('dino_market_entered') === 'true') return;
        if (!confirm("âš ï¸ è­¦å‘Šï¼šé€²å…¥é»‘å¸‚è‹¥ä¸­é€”é€€å‡ºï¼Œé­šå¹£å°‡é‡ç½®ç‚º 3 å€‹ï¼ä¸”é»‘å¸‚è‹¥æ˜¯ä¸­é€”é€€å‡ºå°‡ç„¡æ³•å†æ¬¡é€²å…¥!!ç¢ºå®šé€²å…¥ï¼Ÿ")) return;
        localStorage.setItem('dino_market_entered', 'true');
        checkMarketStatus();
        document.getElementById('black-market-overlay').style.display = 'block';
        currentQuiz = -1; temporaryCoins = 0; showQuestion();
    }

    let showingStory = true; // æ–°å¢ï¼šç”¨ä¾†åˆ‡æ›ã€Œæ•…äº‹é ã€æˆ–ã€Œé¡Œç›®é ã€

    function showQuestion() {
        const storyP = document.getElementById('quiz-story');
        const questionP = document.getElementById('quiz-question');
        const optionsDiv = document.getElementById('quiz-options');
        document.getElementById('quiz-orig-coins').innerText = coins;
        document.getElementById('quiz-temp-coins').innerText = temporaryCoins;

        // --- çµç®—ç•«é¢  ---
        if (currentQuiz >= questions.length) {
            document.getElementById('quiz-coin-board').style.display = 'none';
            storyP.style.color = "#ffffff"; 
            storyP.style.lineHeight = "1.8";
            storyP.innerHTML = 
                "<span style='color:#ffd026; font-size:18px; font-weight:bold;'>ã€Œä½ æ‰¾åˆ°æç‡¦å„ç¨®é¢è²Œçš„ç¢ç‰‡äº†å‘¢...ã€</span><br>" + 
                "ä½ æ¨é–‹å±é¢¨ï¼Œç™¼ç¾äº†è£ç¸«å¸«åœ¨é‚£ç­‰è€…ä½ ã€‚<br>" +
                "è£ç¸«å¸«èªªï¼šã€Œåœ‹ç‹çš„å„ç¨®é¢è²Œä½ éƒ½ååˆ†äº†è§£...ã€<br>" +
                "ã€Œä¸ç®¡æ˜¯ç¶œè—ã€èˆå°ã€ç›´æ’­...ã€<br>" +
                "<span style='color:#ffd026; font-weight:bold;'>é‚£éº¼å°±å¯«ä¸‹ä½ æƒ³è¦çš„ç¨å±¬æ–¼åœ‹ç‹çš„è¡£æœå§! <br>" +
                "<span style='font-size:13px; color:#bbb;'>è£ç¸«å¸«æ•´ç†ä½ çš„æƒ³æ³•ï¼Œè®“ä½ å¸¶è‘—ä½œå“æˆåŠŸå®Œæˆåœ‹ç‹çš„æ™‚è£ç§€ã€‚</span><br>" +
                "<hr style='border:0; border-top:1px solid #444; margin:15px 0;'>" + 
                "<span style='font-size:14px; color:#fff;'>ç„¡è«–ç­”å°é¡Œæ•¸å¤šå¯¡ï¼Œ</span><br>" +
                "<span style='font-size:14px; color:#fff;'>éƒ½æ˜¯å› ç‚ºå–œæ„› DINO æ‰æœƒé»é–‹ç¶²é ï¼Œ</span><br>" +
                "<span style='font-size:14px; color:#fff;'>å¸Œæœ›é€™æ¬¡æ´»å‹•èƒ½è¦ºå¾—æœ‰è¶£ã€‚</span><br>" +
                "<span style='font-size:14px; color:#bbb;'>ä¸‹é¢è¡¨å–®é™¤äº†æ´»å‹•çš„æ±è¥¿ï¼Œä¹Ÿå¯ä»¥å¯«é»æ±è¥¿çµ¦æˆ‘ <br>" +
                "<span style='font-size:14px; color:#bbb;'>å†æ¬¡æ„Ÿè¬ä½ çš„åƒèˆ‡!!ğŸ¦¦ğŸ¦¦ğŸ¦¦</span>";
            const finalCoins = coins + temporaryCoins;
            questionP.innerHTML = `
                <div style="background:#fff; padding:25px; border-radius:15px; color:#000; margin-top:20px; box-shadow: 0 0 20px rgba(255,215,0,0.3);">
                    <span style="font-size:14px; color:#666;">ä¾†è‡ªè£ç¸«å¸«çš„è¬ç¦®</span><br>
                    <div style="margin:10px 0; font-size:26px; font-weight:900;">çå‹µï¼š+${temporaryCoins} ğŸŸ</div>
                    <div style="border-top:1px solid #eee; padding-top:10px; font-size:16px;">ç¸½æŒæœ‰é­šå¹£ï¼š${finalCoins} ğŸŸ</div>
                </div>`;
            
            // 3. ä¸‹æ–¹ï¼šç¢ºèªæŒ‰éˆ•
            optionsDiv.innerHTML = `
                <button class="option-btn" 
                        style="background:#ffe154; color:#000; font-weight:bold; text-align:center; border:none; margin-top:20px;" 
                        onclick="finalizeMarketCoins()">
                    ç¢ºèªé ˜å–ä¸¦ç™»è¨˜
                </button>`;
            return;
        }
            
            

      // --- é–‹é ­ç•«é¢ ---
        if (currentQuiz === -1) {
            storyP.innerHTML = "èº«ç‚ºæ°´çºåœ‹ç‹çš„å­æ°‘ï¼Œä½ æ­£ç‚ºäº†åœ‹ç‹çš„æ™‚è£é€±ä¹‹æ—…å¥”æ³¢...<br>è£ç¸«å¸«å¯„å‡ºé‚€è«‹ï¼Œåªè¦å®Œæˆå¥¹æ‰€è¨­çš„é›£é—œï¼Œä¾¿æœƒå¹«åŠ©ä½ å®Œæˆæœ€é‡è¦çš„æœè£";
            
            // å°‡åŸæœ¬çš„å…§å®¹èˆ‡è­¦å‘Šèªçµåˆ
            questionP.innerHTML = 
                "åœ¨éç¨‹ä¸­äº†è§£æç‡¦çš„å„ç¨®é¢è²Œï¼Œæœ€å¾Œäº¤å‡ºç¨å±¬æ–¼ä½ çš„è¨­è¨ˆã€‚<br>" + 
                "<div style='font-size: 14px; color: #ff6b6b; margin-top: 15px; font-weight: normal; background: rgba(255,107,107,0.1); padding: 10px; border-radius: 8px; border: 1px dashed #ff6b6b;'>" +
                "âš ï¸ æ³¨æ„ï¼šé»‘å¸‚ä¸­è«‹ä¸è¦é‡æ•´ç•«é¢ï¼Œ<br>é€™æœƒå°è‡´é›¢é–‹é»‘å¸‚ä¸”ç„¡æ³•å†æ¬¡é€²å…¥ï¼" +
                "</div>";
                
            optionsDiv.innerHTML = `<button class="option-btn" style="text-align:center; background:#ffd026; color:#000; font-weight:bold;" onclick="currentQuiz=0; showingStory=true; showQuestion();">é–‹å§‹å°‹æ‰¾è£ç¸«å¸«</button>`;
            return;
        }

        // --- æ ¸å¿ƒé‚è¼¯ï¼šç¨ç«‹æ•…äº‹é  vs é¡Œç›®é  ---
        const data = questions[currentQuiz];

        // --- æ ¸å¿ƒé‚è¼¯ï¼šç¨ç«‹æ•…äº‹é  vs é¡Œç›®é  ---
        if (showingStory) {
            // ã€æ•…äº‹é é¢æ¨£å¼ã€‘
            storyP.innerHTML = `
                <div style="font-size:20px; color:#ffd026; line-height:1.6; margin:40px 0; min-height:100px;">
                    ã€Œ ${data.story} ã€
                </div>`;
            questionP.innerText = ""; // æ•…äº‹é ä¸é¡¯ç¤ºé¡Œç›®
            optionsDiv.innerHTML = `<button class="option-btn" style="text-align:center; background:#444;" onclick="showingStory=false; showQuestion();">æŸ¥çœ‹ä¸‹ä¸€å€‹ç·šç´¢ (æŒ‘æˆ°é¡Œ) â†’</button>`;
        } else {
            // ã€é¡Œç›®é é¢æ¨£å¼ã€‘
            storyP.innerHTML = `<div style="color:#888; font-size:14px; margin-bottom:10px;">ç·šç´¢è¿½è¹¤ä¸­...</div>`;
            questionP.style.fontSize = "24px";
            questionP.innerText = data.q;
            optionsDiv.innerHTML = '';
            data.a.forEach((txt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = `${String.fromCharCode(65 + idx)}. ${txt}`;
                btn.onclick = () => {
                    if (idx === data.correct) { 
                        temporaryCoins += 2; 
                        alert("æ­£ç¢ºï¼ç²å¾— 2 é­šå¹£ã€‚"); 
                    } else { 
                        alert("é›–ç„¶ç­”éŒ¯äº†ï¼Œä½†ä½ çš„èª æ„æ„Ÿå‹•äº†è£ç¸«å¸«...ç¹¼çºŒè¿½è¹¤ã€‚"); 
                    }
                    currentQuiz++; 
                    showingStory = true; // ä¸‹ä¸€é¡Œå…ˆé¡¯ç¤ºæ•…äº‹
                    showQuestion();
                };
                optionsDiv.appendChild(btn);
            });
        }
    }

    function handlePenaltyClose() {
        if (confirm("âš ï¸ ç¾åœ¨é›¢é–‹ï¼Œé­šå¹£å°‡ç›´æ¥å›æ­¸ç‚º 3 å€‹ï¼ˆåˆå§‹å€¼ï¼‰ï¼ä¸”ç„¡æ³•å†é€²å…¥é»‘å¸‚ !! ç¢ºå®šå—ï¼Ÿ")) {
            coins = 3;
            localStorage.setItem('dino_coins', coins);
            updateCoinDisplay();
            document.getElementById('black-market-overlay').style.display = 'none';
        }
    }

    function finalizeMarketCoins() {
        const finalCoins = coins + temporaryCoins;
        coins = finalCoins;
        localStorage.setItem('dino_coins', coins);
        updateCoinDisplay();
        const verifyCode = (finalCoins * 17) + 211;
        window.location.href = `${BLACK_MARKET_BASE_URL}&entry.94782409=${finalCoins}&entry.1993098186=${verifyCode}`;
    }

    function addDevTool() {
        const devBtn = document.createElement('div');
        devBtn.className = 'dev-badge'; devBtn.innerText = 'ğŸ› ï¸ DEV';
        devBtn.onclick = () => {
            let cmd = prompt("1.+3 / 2.Reset / 3.Finish");
            if (cmd==='1') { coins+=3; localStorage.setItem('dino_coins', coins); updateCoinDisplay(); }
            if (cmd==='2') { localStorage.setItem('dino_coins', 3); localStorage.removeItem('dino_market_entered'); location.reload(); }
            if (cmd==='3') { currentQuiz = questions.length; showQuestion(); }
        };
        document.body.appendChild(devBtn);
    }
</script>
</body>
</html>





